/*!
**  Thenable -- Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
**  Copyright (c) 2013-2014 Ralf S. Engelschall <http://engelschall.com>
**  Licensed under The MIT License <http://opensource.org/licenses/MIT>
**  Source-Code distributed on <http://github.com/rse/thenable>
*/
!function(a,b,c){"function"==typeof define&&"undefined"!=typeof define.amd?define(b,function(){return c(a)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=c(a):a[b]=function(){var d=a[b],e=c(a);return e.noConflict=function(){return a[b]=d,e},e}()}(this,"Thenable",function(){var a=function(a){return"object"==typeof a},b=function(a){return"function"==typeof a},c=0,d=1,e=2,f=function(a){return this instanceof f?(this.id="Thenable/1.0.2",this.state=c,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],void(b(a)&&a.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new f(a)};f.prototype={fulfill:function(a){return g(this,d,"fulfillValue",a)},reject:function(a){return g(this,e,"rejectReason",a)},then:function(a,b){var c=this,d=new f;return c.onFulfilled.push(j(a,d,"fulfill")),c.onRejected.push(j(b,d,"reject")),h(c),d},proxy:function(){return{then:this.then.bind(this)}}};var g=function(a,b,d,e){return a.state===c&&(a.state=b,a[d]=e,h(a)),a},h=function(a){a.state===d?i(a,"onFulfilled",a.fulfillValue):a.state===e&&i(a,"onRejected",a.rejectReason)},i=function(a,c,d){if(0!==a[c].length){var e=a[c];a[c]=[];var f=function(){for(var a=0;a<e.length;a++)e[a](d)};"object"==typeof process&&b(process.nextTick)?process.nextTick(f):"function"==typeof setImmediate?setImmediate(f):setTimeout(f,0)}},j=function(a,c,d){return function(e){if(b(a)){var f;try{f=a(e)}catch(g){return void c.reject(g)}k(c,f)}else c[d].call(c,e)}},k=function(c,d){if(c===d)return void c.reject(new TypeError("cannot resolve promise with itself"));var e;if(a(d)&&null!==d||b(d))try{e=d.then}catch(f){return void c.reject(f)}if(b(e)){var g=!1;try{e.call(d,function(a){g||(g=!0,a===d?c.reject(new TypeError("circular thenable chain")):k(c,a))},function(a){g||(g=!0,c.reject(a))})}catch(f){g||c.reject(f)}}else c.fulfill(d)};return f});